#set text(size: 15pt, font: ("Arial","Source Han Serif SC"))
#set heading(numbering: "1.")
#align(center)[#text(size: 25pt)[*z变换*]]
= 定义
$ X(z)=sum_(n=-infinity)^(infinity) x[n] z^(-n) $
$z$是个复变量,$z=r e^(j omega)$
$X(z)$是关于$z$的复变函数
== 一些典型的$z$变换
$ delta[n]<-->^z 1 $
$ u[n]<-->^z 1+z^(-1)+z^(-2)+... =1/(1-z^(-1)), |z|>1 "收敛域" $
exp 1.\
$-u[-n-1]$的$z$变换\
$ -sum_(n=-infinity)^(-1) z^(-n)=-[z+z^2+z^3+...] $
$ =z/(z-1)=1/(1-z^(-1)) $
但是:收敛域, $|z|<1$, 不一样的收敛域。
*重要结论*
$ -a^n u[-n-1]<-->z/(z-a) abs(z)<abs(a) $
#figure(caption: [一些常用的$z$变换])[#image("image-7.png")]
= 序列的分类
== 双边
$ -infinity<n<+infinity $
== 右边
$ n>=n_1 $
$ n<n_1, x[n]=0 $
$n_1=0$的情况下又叫做因果序列
== 左边
$ n>n_1, x[n]=0 $
= 极点
exp:
$ 1/(1-z^(-1)) $
$ 1-z^(-1)=0 $
$ |z|=1 $
由极点确定收敛域
+ 右边信号:最右边的极点的外侧$|z|>|z_p|_max$
+ 左边信号:最左边的极点的内侧$|z|<|z_p|_min$
+ 双边序列:$x[n]=sum_(n=-infinity)^(-1) x[n]z^(-n)+sum_(n=0)^infinity x[n]z^(-n)$
  #figure(caption: [双边序列拆分成两个求交集])[#image("image-8.png")]
= 如何利用$z$变换求解差分方程?
== exp1
$ y[n-2]+a y[n-1]+b y[n]=c x[n]+d x[n-1] $
$ y[n-1]<-->z^(-1)Y[z]+y[-1] $ 
$ y[n-2]<-->z^(-2)Y[z]+y[-2] $
输入信号是因果的，初始状态为0
$ x[n-1]<-->z^(-1)X[z] $
$ x[n-2]<-->z^(-2)X[z] $
#image("image-9.png")
== exp2
- 条件
$ y[n]-0.5y[n-1]=x[n] $
$ x[n]=(0.7)^n u[n] $
$ y[-1]=1.5 $
- 解
$ Y[z]-0.5[z^(-1)Y[z]+y[-1]]=X[z] $
$ Y[z]=(1.75z-0.525)/((1-0.5z^(-1))(z-0.7)) $
== 系统函数
$ H(z)=Y(z)/(X(z)) $
= $z$变换的性质
== 线性 
$ a x_1[n]+b x_2[n]<--> a X_1[z]+b X_2[z] $
== 位移性质
$ x[n]<-->X[z] $
$ x[n plus.minus n_0]<-->z^(plus.minus n_0)X[z] $
位移不会改变收敛域
#image("image-10.png")
#image("image-11.png")
=== exp
$ n u[n]<-->z/(z-1)^2 $
求:$(n-1)u[n]$的z变换
$ (n-1)u[n]<-->(z times z^(-1))/(z-1)^2 + x(-1)=1/(z-1)^2 $
=== exp2 
#image("image-12.png")
因果系统，求z变换不用带尾巴，因为可以认为输入之前为0, 输出也为0

$ Y[z]-0.9z^(-1)Y[z]=X[z]+0.9z^(-1)X[z] $
$ Y[z]/X[z]=(1+0.9z^(-1))/(1-0.9z^(-1)) $
== 乘以实指数序列$a^n$
$ x[n]<-->X[z] $
$ a^n x[n]<--> X(a^(-1)z) $
== 序列乘以n 
$ n x[n]<-->-z (d X(z))/(d z) $
== 共轭 
$ x[n]<-->X[z] $
$ x^*[n]<-->X^*[z^*] $
== 初值定理
$ x[0]=lim_(z->infinity) X[z] $
== 终值定理 
$ x(infinity)=lim_(z->1) (z-1)X[z] $
= $z$反变换
== 定义法
$ x(n)=1/(2pi j) integral.cont_c X[z] z^(n-1) d z $
== 观察法
利用常见的变换对
- exp1
$ X[z]=7z^(-1)+3z^2-8z^(-10) $
$ x(z)=7 delta[n-1]+3delta[n-2]-8delta[n-10] $ 
- exp2 
$ X[z]=(z^4-1)/(z^4-z^3) $
$ X[z]=((z+1)(z^2+1))/(z^3)=1+z^(-1)+z^(-2)+z^(-3) $
$ x[n]=delta[n]+delta[n-1]+delta[n-2]+delta[n-3] $
- exp3:形式相同但是收敛域不同 
  $ X[z]=z/(z^2-3z+2)=z/((z-1)(z-2))=z/(z-2)-z/(z-1) $
  - $abs(z)>2$
    2是两个极点中大的那一个，说明是一个右边序列:
    $ x[n]=2^n u[n]-u[n] $
  - $abs(z)<1$
    1是两个极点中小的那一个，说明是左边序列
    $ x(n)=-2^n u[-n-1]+u[-n-1] $
  - $abs(z)>1$
    对应双边序列\
    对于极点2，用左边序列的公式:$-2^n u[-n-1]$\
    对于极点1，用右边序列的公式:$-u[n]$
    $ x[n]=-2^n u[-n-1]-u[n] $
- exp4 
  $ X[z]=(1-z)/(z-0.5) $
  $ =(-z+0.5+0.5)/(z-0.5)=-1+0.5/(z-0.5) $
  后半部分是典型序列的延迟和$times 0.5$
  $ x[n]=-delta[n]+0.5 (0.5)^(n-1) u[n-1]=-delta[n]+0.5^n u[n-1]=0.5^n u[n]-2 delta[n] $
- exp5 
  $ X[z]=z/(z-1)^2 $
  直接记住:$ n u[n]<-->z/(z-1)^2 $\
  $ n a^n u[n]<--> (a z)/(z-a)^2 $
- exp6
#image("image-13.png")
$ Y[z]=z/(z-1/16) $
$ Y[z^2]=z^2/(z^2-1/16)=z/(z-1/4)+z/(z+1/4) $
$ X[z]=z/(z-1/4), X[-z]=(-z)/(-z-1/4)=z/(z+1/4) $
$ x[n]=(1/4)^n u[n] $
or:
$ x[n]=(-1/4)^n u[n] $
== 留数法
=== exp1 
$ X[z]=z/((z-1)(z-2)), abs(z)>2 $
+ 求$X(z)z^(n-1)$的极点
 $ X(z)z^(n-1)=z^n/((z-1)(z-2)) $
 $ z_1=1,z_2=2 $
+ 计算$z_1$的留数
  先去掉含有$z_1$的因式
  $ z^n/(z-2) $
  然后再带入$z_1$, $1/(1-2)=-1$
+ $z_2$的留数
  $ z^n/(z-1) $
  $ 2^n/(2-1)=2^n $
  $ x[n]=(2^n-1) u[n], n>=0 $
=== exp2 
$ X[z]=(2z^2-3z+1)/(z^2-4z-5), abs(z)>5 $
$ X[z]z^(n-1) $
当$n=0$
  $ =(2z^2-3z+1)/(z(z^2-4z-5)) $
极点:$z(z-5)(z+1)=0$, $z_1=0,z_2=5,z_3=-1$
$z_1$的留数:$-1/5$

$z_2$的留数:$6/5$

$z_3$的留数:$1$

单独的数字组成的序列是冲激$(-1/5+6/5+1) delta[n]=2 delta[n]$(只有n=0的时候才成立，那就是冲激了)

当$n>=1$的时候，
$ z^2-4z-5=0, (z-5)(z+1)=0, z_1=5,z_2=-1 $
$z_1=5$:$6 5^(n-1)$

$z_2=-1$:$(-1)^n$

$ x_2[n]=[6/5 5^n+(-1)^n] u[n-1] $
step unit是对所设定$n$的范围进行约束的


合并两个部分:$x[n]=2delta[n]+[6/5 5^n+(-1)^n]u[n-1]$

== 部分分式展开法
